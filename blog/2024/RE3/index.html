<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> III. Introduction to Rare Event Simulation | Boilermakers Machine Learning Collaborative (Boil-MLC) | Students Machine Learning Seminar at Purdue University </title> <meta name="author" content=" "> <meta name="description" content="The Boilermakers Machine Learning Collaborative at Purdue University is a student-led interdisciplinary initiative established to bridge theoretical foundations with practical applications in the field of machine learning. Targeted primarily at PhD and Masters students, BoilMLC aims to leverage the diverse academic backgrounds of its members to foster innovative research and enhance the academic and professional stature of its participants. "> <meta name="keywords" content="Machine Learning, Interdisciplinary Collaboration, Academic Initiative, PhD Students, Research, Innovation, Workshops, Seminars, Purdue University, Computer Science, Mathematics, Statistics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/u1f525_u1f95b.png?ccae948c32cbc6d3f1ace744c1e8707b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://purdue-boilmlc.github.io/blog/2024/RE3/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "III. Introduction to Rare Event Simulation",
            "description": "",
            "published": "July 16, 2024",
            "authors": [
              
              {
                "author": "Yineng Chen",
                "authorURL": "https://chernyn.github.io/",
                "affiliations": [
                  {
                    "name": "Purdue University",
                    "url": "https://www.purdue.edu"
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter abbr-title" href="/"> <img src="/assets/img/u1f525_u1f95b.png" alt="Logo" style="height: 30px; vertical-align: middle; margin-right: 5px; position: relative; top: -2.5px;">Boil-MLC </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/articles/index.html">Articles </a> </li> <li class="nav-item "> <a class="nav-link" href="/events/">Events </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>III. Introduction to Rare Event Simulation</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#exponential-twisting">Exponential Twisting</a> </div> <div> <a href="#case-of-multiple-global-minimizers">Case of Multiple Global Minimizers</a> </div> </nav> </d-contents> <p>In the previous notes, we have talked about the IS estimate of $\pi_{\epsilon}[f_{\epsilon}]$:</p> \[\widetilde{f_M}=\frac{1}{M}\sum_{j=1}^Mf_{\epsilon}(Y^{(j)})\frac{\pi_{\epsilon}(Y^{(j)})}{\widetilde{\pi_{\epsilon}}(Y^{(j)})}\] <p>where each $Y^{(j)}$ is i.i.d drawed from $\widetilde{\pi}$. Furthermore, the IS with the following setting has zero variance:</p> \[\widetilde{\pi}\propto \frac{e^{-g/\epsilon}e^{-V/\epsilon}}{\pi_{\epsilon}[f_{\epsilon}]}\] <p>However, we actually do not know $\pi_{\epsilon}[f_{\epsilon}]$, so in this note we look for a more practical choice that still prevents the exponential growth.</p> <h2 id="exponential-twisting">Exponential Twisting</h2> <p>We explore to use the following setting:</p> \[\widetilde{\pi}_{\epsilon}(x)\propto e^{-\widetilde{V}/\epsilon}\] <p>where $\widetilde{V}=V(x)-\omega^T x -\text{min}_x{V(x)-\omega^Tx}$ for some fixed choice of $\omega\in \mathbb{R}^d$, so we have</p> \[\widetilde{\pi}_{\epsilon}(x)=\frac{\pi_{\epsilon}(x)e^{-\omega^Tx}}{\pi_{\epsilon}[e^{-\omega^Tx}]}\] <p>If $\pi_{\epsilon}$ is Gaussian, this is a shift of the mean. We compute then compute the relative error</p> \[\frac{\text{var}(\widetilde{f_M})}{(\pi_{\epsilon}[f_{\epsilon}])^2}=\frac{1}{M}\left(\frac{\widetilde{\pi_{\epsilon}}[f_{\epsilon}^2(\frac{\pi_{\epsilon}}{\widetilde{\pi_{\epsilon}}})^2]}{\pi_{\epsilon}[f_{\epsilon}]^2}-1\right)\] <p>Apply the Laplace Principle with</p> \[h=\widetilde{V}+2g+2(V-\widetilde{V})=2g+2V-\widetilde{V}\] <p>we have</p> \[\epsilon\,\text{log}\frac{\widetilde{\pi_{\epsilon}}[f_{\epsilon}^2(\frac{\pi_{\epsilon}}{\widetilde{\pi_{\epsilon}}})^2]}{\pi_{\epsilon}[f_{\epsilon}]^2}\rightarrow \text{min}_x\{2g+2V\}-\text{min}_x\{2g+2V-\widetilde{V}\}\] <p>We denote the right hand side as $\widetilde{\gamma}(\omega)$ and in the next step, we try to find an appropriate $\omega$ to make it equal to zero.</p> <p>Let $x_{g+V}$ be a global minimizer of $g+V$. In this way,</p> \[\widetilde{\gamma}(\omega)=2g(x_{g+V})+2V(x_{g+V})-\text{min}_x\{2g+2V-\widetilde{V}\}\geq \widetilde{V}(x_{g+V})\] <p>Choose $\omega=\nabla V(x_{g+V})$. Since $\nabla V(x_{g+V})=\nabla \widetilde{V}(x_{g+V})-\omega=0$, $x_{g+V}$ is at least a critical point of $\widetilde{V}$.</p> <p>If we further assume the following the conditions:</p> <ol> <li> <p>$x_{g+V}$ is a global minimizer of $\widetilde{V}$ s.t. $\widetilde{V}(x_{g+V})$=0;</p> </li> <li> <p>$x_{g+V}$ is a global minimizer of $2g+2V-\widetilde{V}$ s.t. $\text{min}<em>x{2g+2V-\widetilde{V}}=2g(x</em>{g+V})+2V(x_{g+V})-\widetilde{V}(x_{g+V})=2g(x_{g+V})+2V(x_{g+V})$;</p> </li> </ol> <p>Then we get</p> \[\widetilde{\gamma}(\omega)=2g(x_{g+V})+2V(x_{g+V})-\text{min}_x\{2g+2V-\widetilde{V}\}=0\] <p>Condition 1 will be satisfied any time $V$ is convex (and thus $\widetilde{V}$ is convex). Condition 2 is actually pretty severe. To make it clear, let us look at the following example:</p> <blockquote> <p>Consider the $\mathbb{R}^2$ space. $g(x)=\infty$ if $x\notin B$ and $g(x)=0$ if $x\in B$. As shown in the picture, the nested circles are the level sets of $V$ and the shaded region is the feasible domain, i.e., the set $B$. $x_1,x_2$ are both the minimizers of $g+V$. Suppose $\omega=\nabla V(x_1)$, then</p> \[\begin{equation*} \begin{aligned} &amp;2g(x_1)+2V(x_1)-\widetilde{V}(x_1)-(2g(x_2)+2V(x_2)-\widetilde{V}(x_2))\\=&amp;\widetilde{V}(x_2)-\widetilde{V}(x_1)\\=&amp;V(x_2)-V(x_1)-\nabla V(x_1)(x_2-x_1)&gt;0 \;(\text{since V is convex}) \end{aligned} \end{equation*}\] <p>In this way, $x_1$ fails to be the global minimizer of $2g+2V-\widetilde{V}$ and thus condition 2 fails.</p> </blockquote> <h2 id="case-of-multiple-global-minimizers">Case of Multiple Global Minimizers</h2> <p>For multiple global minimizers $x_1,x_2,x_3,…, x_m$ of $g+V$. We use IS with</p> \[\widetilde{\pi}_{\epsilon}=\sum_{i=1}^m q_i\frac{e^{-\widetilde{V_i}/\epsilon}}{z_i}\] <p>where $q_i&gt;0$ and $\sum_i q_i=1$. $\widetilde{V}(x_i)=V(x)-\nabla V(x_i) x -\text{min}_x{V(x)-\nabla V(x_i)x}$ and $z_i=\int e^{-\widetilde{V}(x_i)/\epsilon}dx$.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2024-07-10-mist.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"Purdue-BoilMLC/Purdue-BoilMLC.github.io","data-repo-id":"","data-category":"General","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 . Made with ❤ by <a href="https://Purdue-BoilMLC.github.io">Boil-MLC</a>. The source code is licensed <a href="https://github.com/Purdue-BoilMLC/Purdue-BoilMLC.github.io/blob/master/LICENSE" rel="external nofollow noopener" target="_blank">MIT</a>. Last updated: August 25, 2024. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-K5X43VBBDE"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-K5X43VBBDE");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>