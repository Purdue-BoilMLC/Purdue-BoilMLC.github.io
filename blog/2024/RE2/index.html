<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> II. Introduction to Rare Event Simulation | Boilermakers Machine Learning Collaborative (Boil-MLC) | Students Machine Learning Seminar at Purdue University </title> <meta name="author" content=" "> <meta name="description" content="The Boilermakers Machine Learning Collaborative at Purdue University is a student-led interdisciplinary initiative established to bridge theoretical foundations with practical applications in the field of machine learning. Targeted primarily at PhD and Masters students, BoilMLC aims to leverage the diverse academic backgrounds of its members to foster innovative research and enhance the academic and professional stature of its participants. "> <meta name="keywords" content="Machine Learning, Interdisciplinary Collaboration, Academic Initiative, PhD Students, Research, Innovation, Workshops, Seminars, Purdue University, Computer Science, Mathematics, Statistics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/u1f525_u1f95b.png?ccae948c32cbc6d3f1ace744c1e8707b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://purdue-boilmlc.github.io/blog/2024/RE2/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "II. Introduction to Rare Event Simulation",
            "description": "",
            "published": "July 15, 2024",
            "authors": [
              
              {
                "author": "Yineng Chen",
                "authorURL": "https://chernyn.github.io/",
                "affiliations": [
                  {
                    "name": "Purdue University",
                    "url": "https://www.purdue.edu"
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter abbr-title" href="/"> <img src="/assets/img/u1f525_u1f95b.png" alt="Logo" style="height: 30px; vertical-align: middle; margin-right: 5px; position: relative; top: -2.5px;">Boil-MLC </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Articles </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Events </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>II. Introduction to Rare Event Simulation</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#importance-sampling-is">Importance Sampling (IS)</a> </div> <div> <a href="#an-asymptotic-rare-event-setting">An Asymptotic Rare Event Setting</a> </div> </nav> </d-contents> <h2 id="importance-sampling-is">Importance Sampling (IS)</h2> <p>Considering the bad behavior of the simplest estimator in the last note, We try to change the ditribution give a new estimator:</p> \[\widetilde{f_M}=\frac{1}{M}\sum_{j=1}^Mf(Y^{(j)})\frac{\pi(Y^{(j)})}{\widetilde{\pi}(Y^{(j)})}\] <p>This estimator is <strong>unbiased</strong>, in the sense that</p> \[\mathbb{E}[\widetilde{f_M}]=\mathbb{E}_{\pi}[f(Y)\frac{\pi(Y)}{\widetilde{\pi}(Y)}]=\int f(y)\frac{\pi(y)}{\widetilde{\pi}(y)}\widetilde{\pi}(y)dy=\pi[f]\] <p>In this way, we have</p> \[\begin{equation*} \begin{aligned} \text{var}(\widetilde{f_M})&amp;=\frac{1}{M}\text{var}_{\widetilde{\pi}}(f(Y)\frac{\pi(Y)}{\widetilde{\pi}(Y)})\\&amp;=\frac{1}{M}\left[\int \left(f(y)\frac{\pi(y)}{\widetilde{\pi}(y)}\right)^2\widetilde{\pi}(y)dy-\pi[f]^2\right] \end{aligned} \end{equation*}\] <p>We notice that</p> \[\int \left(f(y)\frac{\pi(y)}{\widetilde{\pi}(y)}\right)^2\widetilde{\pi}(y)dy\geq \left(\int \vert f(y)\vert \pi(y)\right)^2=\pi[\vert f\vert]^2\] <p>The first inequality is by Jensen’s Inequality. The second quality holds if</p> \[\widetilde{\pi}(x)=\frac{\vert f(x)\vert \pi(x)}{\int\vert f(y)\vert \pi(y)dy}\] <p>So $\widetilde{\pi} \propto \vert f\vert \pi$ is the optimal choice. However, we can not sample independently from $\widetilde{\pi}$ and we even do not know the ratio $\frac{\pi}{\widetilde{\pi}}$. Our method is to approximate the $\widetilde{\pi}$ as in the following section.</p> <p>Although we do not know the ratio, sometimes we know this up to a multiplicative constant.</p> <p>If $\pi\propto p$ and $\widetilde{\pi}\propto\widetilde{p}$, we can use the <strong>Autonormalized IS</strong>:</p> \[\frac{\widetilde{f_M}}{\widetilde{1_M}}=\frac{\frac{1}{M}\sum_{j=1}^Mf(Y^{(j)})\frac{\pi(Y^{(j)})}{\widetilde{\pi}(Y^{(j)})}}{\frac{1}{M}\sum_{j=1}^M\frac{\pi(Y^{(j)})}{\widetilde{\pi}(Y^{(j)})}}=\frac{\frac{1}{M}\sum_{j=1}^Mf(Y^{(j)})\frac{p(Y^{(j)})}{\widetilde{p}(Y^{(j)})}}{\frac{1}{M}\sum_{j=1}^M\frac{p(Y^{(j)})}{\widetilde{p}(Y^{(j)})}}\] <h2 id="an-asymptotic-rare-event-setting">An Asymptotic Rare Event Setting</h2> <p>In this section, we use an <strong>asymptotic setting</strong> to quantify the performance of choosing $\widetilde{\pi}$</p> <p>Let $V$ and $g$ be upper semi-continuous functions. We also assume that g is bounded below and $\text{lim inf}<em>{|x|\rightarrow \infty}\frac{V(x)}{|x|}=\infty$ and $\text{inf}_x V(x)=0$. Let $\pi</em>{\epsilon}\propto e^{-V(x)/\epsilon}$ and $f_{\epsilon}(x)=e^{-g(x)/\epsilon}$. However, it is hard to estimate $\pi_{\epsilon}[f_{\epsilon}]$ for small $\epsilon$ as we will show below.</p> <p>Before that we will introduce an important theorem without proof.</p> <blockquote> <h3 id="laplace-principle"><strong>Laplace Principle</strong></h3> <p>For any upper semi-continuous fucntion $h$ with $\text{lim}<em>{|x|\rightarrow \infty}\frac{h(x)}{|x|}=\infty$ and $h</em>{}=\text{inf}_x h(x)&gt;\infty$, then we have</p> \[\text{lim}_{\epsilon\rightarrow 0} \;\epsilon \,\text{log}\int e^{-h(x)/\epsilon} dx = -h_{*}\] </blockquote> <p>This implies</p> \[\int e^{-h(x)/\epsilon} dx = e^{-(h_{*}+\omicron(1))/\epsilon}\] <p>We call the term $e^{-\omicron(1)/\epsilon}$ the prefactor. In fact, we can characterize the prefactor more precisely. For example,</p> <blockquote> <h3 id="saddle-point-approximation"><strong>Saddle Point Approximation</strong></h3> <p>Based on the conditions of the Laplace Principle, we further assume that $h\in C^2$ and has a unique global minimum at $x_h$. We also assume that $D^2h(x_h)$ is positive definite, then we have</p> \[\int e^{-h(x)/\epsilon} dx = \epsilon^{d/2}e^{-h(x_h)/\epsilon}\left(\frac{(2\pi)^{d/2}}{\vert Dh(x_h)\vert^{1/2}}+\omicron(1)\right)\] </blockquote> <p>Finally, we use the Laplace Principle to find the decay rate of $\pi_{\epsilon}[f_{\epsilon}]$. Note that $h:=V+g$ is upper semi-continuous and bounded below, so we have</p> \[\epsilon\text{log}\int e^{-V(x)/\epsilon}e^{-g(x)/\epsilon}\rightarrow -\text{inf}_x \{V(x)+g(x)\}\] <p>so we get</p> \[\epsilon\text{log}(\pi_{\epsilon}[f_{\epsilon}])\rightarrow -\text{inf}_x \{V(x)+g(x)\}\] <p>In a similar style we consider $\pi_{\epsilon}[f_{\epsilon}^2]$ by applying Laplace Principle to $h=V+2g$ and we get</p> \[\epsilon\text{log}(\pi_{\epsilon}[f_{\epsilon}^2])\rightarrow -\text{inf}_x \{V(x)+2g(x)\}\] <p>Since the relative variance of $\overline{f_M}$ is</p> \[\frac{\text{var}(\overline{f_M})}{\pi_{\epsilon}[f_{\epsilon}]^2}=\frac{1}{M}\left(\frac{\pi_{\epsilon}[f_{\epsilon}^2]}{\pi_{\epsilon}[f_{\epsilon}]^2}-1\right)\] <p>we have</p> \[\epsilon\text{log}\frac{\text{var}(\overline{f_M})}{\pi_{\epsilon}[f_{\epsilon}]^2}\rightarrow \text{inf}_x \{2V(x)+2g(x)\}-\text{inf}_x \{V(x)+2g(x)\}\] <p>we denote the right hand side as $\gamma$. If $\gamma&gt;0$, the relative variance will grow exponentially with rate $\gamma$, which is bad. We will explore some methods to eliminate the growth.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2024-07-10-mist.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"Purdue-BoilMLC/Purdue-BoilMLC.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 . Made with ❤ by <a href="https://Purdue-BoilMLC.github.io">Boil-MLC</a>. The source code is licensed <a href="https://github.com/Purdue-BoilMLC/Purdue-BoilMLC.github.io/blob/master/LICENSE" rel="external nofollow noopener" target="_blank">MIT</a>. Last updated: July 17, 2024. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>